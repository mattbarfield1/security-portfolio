# Vulnerability Assessment Report

This report identifies known security weaknesses within the application infrastructure. Each vulnerability is assessed based on its exploitability and potential impact on the business and user data (PII/PHI).

## Vulnerability Inventory

### 1. Hardcoded API Keys in Client-Side Code
* **Description:** Firebase API keys and third-party integration tokens are visible in the frontend JavaScript bundle.
* **Exploitability:** High. Any user can view the source code via browser developer tools.
* **Business Impact:** High. An attacker could use these keys to bypass frontend restrictions, scrape data, or incur unauthorized compute costs (see Incident Report in Step 9).
* **Recommendation:** Implement **Firebase App Check** to ensure only authorized web clients can call the API, and move sensitive logic to backend Cloud Functions.

### 2. Lack of Rate Limiting on Authentication Endpoints
* **Description:** The login and password reset endpoints do not have strict rate limits based on IP address.
* **Exploitability:** Medium. Attackers can perform automated brute-force or credential stuffing attacks.
* **Business Impact:** Medium. Increased risk of account takeover (ATO) and unauthorized access to health metrics.
* **Recommendation:** Implement a rate-limiting middleware in Cloud Functions and enable Google Cloud Armor to block high-frequency request patterns.

### 3. Overly Permissive Default Firestore Rules
* **Description:** Initial security rules allowed read access to entire collections without verifying document ownership.
* **Exploitability:** High. An authenticated user could potentially query documents belonging to other users.
* **Business Impact:** Critical. Direct exposure of PHI (Weight/Recovery metrics), leading to regulatory non-compliance (HIPAA/GDPR).
* **Recommendation:** Update rules to strictly enforce `request.auth.uid == resource.data.userId` for all read/write operations.

### 4. Absence of Multi-Factor Authentication (MFA) for Support Staff
* **Description:** Administrative and support accounts rely solely on passwords for access to the GCP console.
* **Exploitability:** Medium. Passwords can be compromised via phishing or credential harvesting.
* **Business Impact:** High. A single compromised support account could lead to a large-scale data leak.
* **Recommendation:** Enforce MFA (TOTP or Hardware Keys) for all users with access to production environments (Step 5).

## Remediation Tracking
| Vulnerability | Status | Priority | Target Date |
| :--- | :--- | :--- | :--- |
| Hardcoded Keys | In Progress | High | 2026-03-01 |
| Rate Limiting | Open | Medium | 2026-04-15 |
| Firestore Rules | Resolved | Critical | 2026-02-10 |
| Missing MFA | Resolved | High | 2026-02-12 |
